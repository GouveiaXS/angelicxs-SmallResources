-- IF poly = true, loc must be a table of vector3s eg. loc = {vector3(1,2,3), vector3(1,2,3), vector3(1,2,3)},


permStash = {
    {
        stashName = "GFC_Crafting_Stash",
        poly = false,
        loc = vector3(120.95649719238, 188.3203125, 104.82014465332), 
        size = vector3(1, 1, 1),
        jobrequired = true,
        gangrequired = false,
        gang = {},
        job = {'gunshop'},
        jobGrade = 0,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
    {
        stashName = "Luckywheels",
        poly = false,
        loc = vector3(1723.82, 4782.5, 42.0),
        size = vector3(2, 2, 2),
        jobrequired = true,
        gangrequired = false,
        -- gang = {},
        job = {'bikedealer'},
        jobGrade = 4,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
    {
        stashName = "EliteAutos",
        poly = false,
        loc = vector3(-78.32, 90.23, 71.72),
        size = vector3(2, 2, 2),
        jobrequired = true,
        gangrequired = false,
        -- gang = {},
        job = {'eliteautos'},
        jobGrade = 0,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
    {
        stashName = "playboymansiongarage ",
        poly = false,
        loc = vector3(-1539.5, 81.94, 56.75),
        size = vector3(2, 2, 2),
        jobrequired = false,
        gangrequired = false,
        -- gang = {},
        job = {'deadmanrunning'},
        jobGrade = 0,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
    {
        stashName = "Dead_Man_Front_Desk",
        poly = false,
        loc = vector3(1146.98, -443.9, 66.98),
        size = vector3(2, 2, 2),
        jobrequired = true,
        gangrequired = false,
        -- gang = {},
        job = {'deadmanrunning'},
        jobGrade = 0,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
    {
        stashName = "Stevos Desk",
        poly = false,
        loc = vector3(686.93, 922.15, 247.58),
        size = vector3(2, 2, 2),
        jobrequired = true,
        gangrequired = false,
        -- gang = {},
        job = {'gunshop'},
        jobGrade = 0,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
    {
        stashName = "ODelli",
        poly = false,
        loc = vector3(-127.3, 863.68, 232.8),
        size = vector3(4, 4, 4),
        jobrequired = true,
        gangrequired = false,
        -- gang = {},
        job = {'uwu'},
        jobGrade = 0,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
    {
        stashName = "Daisy",
        poly = false,
        loc = vector3(-168.73, 915.96, 239.88),
        size = vector3(4, 4, 4),
        jobrequired = true,
        gangrequired = false,
        -- gang = {},
        job = {'mechanic2'},
        jobGrade = 0,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
    {
        stashName = "GFC_Front_Desk",
        poly = false,
        loc = vector3(126.22973632812, 181.61366271973, 104.82023620605), 
        size = vector3(3, 3, 3),
        jobrequired = true,
        job_gradeup = 1,
        gangrequired = false,
        gang = {},
        job = {'gunshop'},
        jobGrade = 0,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
    {
        stashName = "Jakes_Private_Stash",
        poly = false,
        loc = vector3(113.93, 189.33, 99.29), 
        size = vector3(1, 1, 1),
        jobrequired = true,
        job_gradeup = 4,
        gangrequired = false,
        gang = {},
        job = {'gunshop'},
        jobGrade = 0,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
    {
        stashName = "Jakes_Room",
        poly = false,
        loc = vector3(651.83618164062, 925.10321044922, 252.58113098145), 
        size = vector3(3, 3, 3),
        jobrequired = true,
        job_gradeup = 4,
        gangrequired = false,
        gang = {},
        job = {'gunshop'},
        jobGrade = 0,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
    {
        stashName = "Eves_Stash",
        poly = false,
        loc = vector3(860.15502929688, -179.1318359375, 78.481742858887), 
        size = vector3(3, 3, 3),
        jobrequired = true,
        gangrequired = false,
        gang = {},
        job = {'evesunderground'},
        jobGrade = 0,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
    {
        stashName = "Tropical_1",
        poly = false,
        loc = vector3(316.42510986328, -937.27709960938, 52.802215576172), 
        size = vector3(3, 3, 3),
        jobrequired = true,
        job_gradeup = 3,
        gangrequired = false,
        gang = {},
        job = {'tropicalheights'},
        jobGrade = 0,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
    {
        stashName = "Tropical_2",
        poly = false,
        loc = vector3(309.80197143555, -937.20593261719, 52.802253723145), 
        size = vector3(3, 3, 3),
        jobrequired = true,
        job_gradeup = 2,
        gangrequired = false,
        gang = {},
        job = {'tropicalheights'},
        jobGrade = 0,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
    {
        stashName = "Tropical_3",
        poly = false,
        loc = vector3(296.51, -908.79, 52.83), 
        size = vector3(3, 3, 3),
        jobrequired = true,
        job_gradeup = 1,
        gangrequired = false,
        gang = {},
        job = {'tropicalheights'},
        jobGrade = 0,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
    {
        stashName = "Penthouse_Stash",
        poly = false,
        loc = vector3(-291.84, -723.86, 125.23), 
        size = vector3(3, 3, 3),
        jobrequired = true,
        job_gradeup = 7,
        gangrequired = false,
        gang = {},
        job = {'sasp'},
        jobGrade = 0,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
    {
        stashName = "LuckyPlucker",
        poly = false,
        loc = vector3(138.96, -1470.19, 29.38), 
        size = vector3(3, 3, 3),
        jobrequired = true,
        job_gradeup = 0,
        gangrequired = false,
        gang = {},
        job = {'luckyplucker'},
        jobGrade = 0,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
    {
        stashName = "Playboy Mansion Master",
        poly = false,
        loc = vector3(-1539.56, 97.41, 60.79), 
        size = vector3(3, 3, 3),
        jobrequired = false,
        gangrequired = false,
        stashSize = 1000000000,
        stashSlots = 125, 
        policeForceOpen = true,
    },
}


for k, v in pairs(permStash) do
    if v.poly then
        exports.ox_target:addPolyZone({
            points = v.loc,
            thickness = 2,
            debug = drawZones,
            options = {
                {
                    name = v.loc,
                    icon = 'fas fa-hand',
                    label = v.stashName,
                    onSelect = function()
                        TriggerEvent('angelicxs-permstash', v, v.stashName)
                    end,
                }
            }
        })
    else
        exports.ox_target:addBoxZone({
            coords = v.loc,
            size = v.size,
            rotation = 10.10,
            debug = drawZones,
            options = {
                {
                    name = v.loc,
                    icon = 'fas fa-hand',
                    label = v.stashName,
                    onSelect = function()
                        TriggerEvent('angelicxs-permstash', v, v.stashName)
                    end,
                }
            }
        })
    end
end


RegisterNetEvent('angelicxs-permstash', function(currentstash, stashName)

    local PlayerData = QBCore.Functions.GetPlayerData()
    local PlayerJob = PlayerData.job.name
    local PlayerGang = PlayerData.gang.name
    local canOpen = false

    if currentstash.policeForceOpen then 
        if PlayerJob == "sasp" then
            canOpen = true
        end
    end

    if currentstash.jobrequired then 
        local jobs = currentstash.job
        for i = 1, #jobs do
            if PlayerJob == jobs[i] and PlayerData.job.grade.level>= currentstash.jobGrade then
                canOpen = true
                break
            end
        end
    end

    if currentstash.gangrequired then
        local gang = currentstash.gang
        for i = 1, #gang do
            if PlayerJob == gang[i] then
                canOpen = true
                break
            end
        end
    end

    if not currentstash.gangrequired and not currentstash.jobrequired then
        canOpen = true
    end

    if canOpen then 
        TriggerServerEvent("inventory:server:OpenInventory", "stash", stashName, {maxweight = currentstash.stashSize, slots = currentstash.stashSlots})
        TriggerEvent("inventory:client:SetCurrentStash", stashName)
    else
        QBCore.Functions.Notify('You cannot open this', 'error')
    end

end)